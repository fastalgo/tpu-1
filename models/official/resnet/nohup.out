Removing gs://bert-pretrain-data/imagenet/infer/#1557963174111468...
/ [1 objects]                                                                   Removing gs://bert-pretrain-data/imagenet/infer/checkpoint#1557963175080793...
/ [2 objects]                                                                   Removing gs://bert-pretrain-data/imagenet/infer/events.out.tfevents.1557961016.v3-64-4tb#1557963177979458...
/ [3 objects]                                                                   Removing gs://bert-pretrain-data/imagenet/infer/events.out.tfevents.1557961043.n-7cef505e-w-0.v2#1557963178457311...
/ [4 objects]                                                                   
==> NOTE: You are performing a sequence of gsutil operations that may
run significantly faster if you instead use gsutil -m rm ... Please
see the -m section under "gsutil help options" for further information
about when gsutil -m can be advantageous.

Removing gs://bert-pretrain-data/imagenet/infer/graph.pbtxt#1557961030588898...
/ [5 objects]                                                                   Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-0.data-00000-of-00001#1557961037108971...
/ [6 objects]                                                                   Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-0.index#1557961037300414...
/ [7 objects]                                                                   Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-0.meta#1557961039806381...
/ [8 objects]                                                                   Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-10008.data-00000-of-00001#1557962569244738...
/ [9 objects]                                                                   Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-10008.index#1557962569455827...
/ [10 objects]                                                                  Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-10008.meta#1557962571602527...
/ [11 objects]                                                                  Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-14074.data-00000-of-00001#1557963174413860...
/ [12 objects]                                                                  Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-14074.index#1557963174590807...
/ [13 objects]                                                                  Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-14074.meta#1557963176782883...
/ [14 objects]                                                                  Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-5004.data-00000-of-00001#1557961823521333...
/ [15 objects]                                                                  Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-5004.index#1557961823703407...
/ [16 objects]                                                                  Removing gs://bert-pretrain-data/imagenet/infer/model.ckpt-5004.meta#1557961825907982...
/ [17 objects]                                                                  Removing gs://bert-pretrain-data/imagenet/infer/eval/#1557963211274732...
/ [18 objects]                                                                  Removing gs://bert-pretrain-data/imagenet/infer/eval/events.out.tfevents.1557963211.v3-64-4tb#1557963212842096...
/ [19 objects]                                                                  
Operation completed over 19 objects.                                             
/home/yangyouucb/tpu-1/models/hyperparameters/hyperparameters.py:123: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  overrides = yaml.load(f)
I0515 23:50:43.984318 139657779209984 hyperparameters.py:100] 
Model hyperparameters [source]:
label_smoothing: 	0.0 	[default.yaml]
skip_host_call: 	False 	[default.yaml]
weight_decay: 	0.0001 	[default.yaml]
train_steps: 	14074 	[Command-line flags]
dropblock_groups: 	 	[default.yaml]
num_label_classes: 	1000 	[default.yaml]
poly_rate: 	0.0 	[default.yaml]
base_learning_rate: 	0.1 	[default.yaml]
data_format: 	channels_last 	[default.yaml]
num_parallel_calls: 	8 	[default.yaml]
precision: 	bfloat16 	[default.yaml]
eval_batch_size: 	1024 	[default.yaml]
momentum: 	0.9 	[default.yaml]
resnet_depth: 	50 	[default.yaml]
transpose_input: 	True 	[default.yaml]
train_batch_size: 	8192 	[Command-line flags]
use_async_checkpointing: 	False 	[default.yaml]
num_eval_images: 	50000 	[default.yaml]
use_tpu: 	True 	[default.yaml]
enable_lars: 	True 	[Command-line flags]
dropblock_keep_prob: 	0.9 	[default.yaml]
image_size: 	224 	[default.yaml]
num_cores: 	64 	[Command-line flags]
num_train_images: 	1281167 	[default.yaml]
dropblock_size: 	7 	[default.yaml]
iterations_per_loop: 	1251 	[default.yaml]
use_cache: 	True 	[default.yaml]

W0515 23:50:44.001879 139657779209984 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/discovery_cache/__init__.py", line 36, in autodetect
    from google.appengine.api import memcache
ImportError: No module named 'google.appengine'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 33, in <module>
    from oauth2client.contrib.locked_file import LockedFile
ImportError: No module named 'oauth2client.contrib.locked_file'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 37, in <module>
    from oauth2client.locked_file import LockedFile
ImportError: No module named 'oauth2client.locked_file'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
I0515 23:50:44.002605 139657779209984 discovery.py:272] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1alpha1/rest
I0515 23:50:44.052776 139657779209984 discovery.py:873] URL being requested: GET https://tpu.googleapis.com/v1alpha1/projects/cloud-tpu-colab-integration/locations/europe-west4-a/nodes/v3-64-4tb?alt=json
I0515 23:50:44.053113 139657779209984 transport.py:157] Attempting refresh to obtain initial access_token
W0515 23:50:44.210235 139657779209984 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/discovery_cache/__init__.py", line 36, in autodetect
    from google.appengine.api import memcache
ImportError: No module named 'google.appengine'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 33, in <module>
    from oauth2client.contrib.locked_file import LockedFile
ImportError: No module named 'oauth2client.contrib.locked_file'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 37, in <module>
    from oauth2client.locked_file import LockedFile
ImportError: No module named 'oauth2client.locked_file'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
I0515 23:50:44.211951 139657779209984 discovery.py:272] URL being requested: GET https://www.googleapis.com/discovery/v1/apis/tpu/v1alpha1/rest
I0515 23:50:44.260021 139657779209984 discovery.py:873] URL being requested: GET https://tpu.googleapis.com/v1alpha1/projects/cloud-tpu-colab-integration/locations/europe-west4-a/nodes/v3-64-4tb?alt=json
I0515 23:50:44.260308 139657779209984 transport.py:157] Attempting refresh to obtain initial access_token
I0515 23:50:44.376481 139657779209984 estimator.py:201] Using config: {'_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f047f032e80>, '_protocol': None, '_evaluation_master': 'grpc://10.240.1.180:8470', '_num_ps_replicas': 0, '_task_type': 'worker', '_keep_checkpoint_max': 5, '_save_checkpoints_secs': None, '_service': None, '_device_fn': None, '_global_id_in_cluster': 0, '_save_summary_steps': 100, '_tpu_config': TPUConfig(iterations_per_loop=1251, num_shards=64, num_cores_per_replica=None, per_host_input_for_training=3, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_num_worker_replicas': 1, '_save_checkpoints_steps': 5000, '_eval_distribute': None, '_keep_checkpoint_every_n_hours': 10000, '_tf_random_seed': None, '_session_config': graph_options {
  rewrite_options {
    disable_meta_optimizer: true
  }
}
cluster_def {
  job {
    name: "worker"
    tasks {
      key: 0
      value: "10.240.1.180:8470"
    }
    tasks {
      key: 1
      value: "10.240.1.178:8470"
    }
    tasks {
      key: 2
      value: "10.240.1.181:8470"
    }
    tasks {
      key: 3
      value: "10.240.1.184:8470"
    }
    tasks {
      key: 4
      value: "10.240.1.179:8470"
    }
    tasks {
      key: 5
      value: "10.240.1.185:8470"
    }
    tasks {
      key: 6
      value: "10.240.1.183:8470"
    }
    tasks {
      key: 7
      value: "10.240.1.182:8470"
    }
  }
}
, '_master': 'grpc://10.240.1.180:8470', '_log_step_count_steps': None, '_train_distribute': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f047ee65128>, '_model_dir': 'gs://bert-pretrain-data/imagenet/infer/', '_experimental_distribute': None, '_task_id': 0}
I0515 23:50:44.376918 139657779209984 tpu_context.py:202] _TPUContext: eval_on_tpu True
I0515 23:50:44.377423 139657779209984 resnet_main.py:598] Precision: bfloat16
I0515 23:50:44.377496 139657779209984 resnet_main.py:617] Using dataset: gs://bert-pretrain-data/imagenet/imagenet-2012-tfrecord/
I0515 23:50:44.496205 139657779209984 resnet_main.py:670] Training for 14074 steps (90.22 epochs in total). Current step 0.
I0515 23:50:44.604748 139657779209984 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.180:8470) for TPU system metadata.
2019-05-15 23:50:44.608038: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
I0515 23:50:44.629772 139657779209984 tpu_system_metadata.py:120] Found TPU system:
I0515 23:50:44.630069 139657779209984 tpu_system_metadata.py:121] *** Num TPU Cores: 64
I0515 23:50:44.630553 139657779209984 tpu_system_metadata.py:122] *** Num TPU Workers: 8
I0515 23:50:44.630614 139657779209984 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
I0515 23:50:44.630670 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 2820178859957775172)
I0515 23:50:44.630923 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 13732020765929608197)
I0515 23:50:44.630997 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 7622213616663427716)
I0515 23:50:44.631050 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 17966088247940653669)
I0515 23:50:44.631100 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 6184262826509945169)
I0515 23:50:44.631149 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 7282308567223618737)
I0515 23:50:44.631197 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6779097012615225299)
I0515 23:50:44.631245 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 3778218325931803250)
I0515 23:50:44.631293 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 9559316629875724152)
I0515 23:50:44.631342 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 6544001410460982665)
I0515 23:50:44.631400 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 531393823275751098)
I0515 23:50:44.631449 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:CPU:0, CPU, -1, 2012823925916292760)
I0515 23:50:44.631496 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:XLA_CPU:0, XLA_CPU, 17179869184, 17187020596528457314)
I0515 23:50:44.631544 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:TPU:0, TPU, 17179869184, 18188776563918627633)
I0515 23:50:44.631594 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:TPU:1, TPU, 17179869184, 6138339589422681871)
I0515 23:50:44.631640 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:TPU:2, TPU, 17179869184, 13621330621064171396)
I0515 23:50:44.631688 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:TPU:3, TPU, 17179869184, 10981156327640356309)
I0515 23:50:44.631737 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:TPU:4, TPU, 17179869184, 9169850994252460332)
I0515 23:50:44.631784 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:TPU:5, TPU, 17179869184, 8163462088833952886)
I0515 23:50:44.631844 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:TPU:6, TPU, 17179869184, 2926888275869130237)
I0515 23:50:44.631895 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:TPU:7, TPU, 17179869184, 10005183943175246586)
I0515 23:50:44.631943 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:1/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 13890276510499980170)
I0515 23:50:44.631990 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:CPU:0, CPU, -1, 3720619313436952474)
I0515 23:50:44.632045 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:XLA_CPU:0, XLA_CPU, 17179869184, 1092515637272283035)
I0515 23:50:44.632093 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:TPU:0, TPU, 17179869184, 1166970453821256190)
I0515 23:50:44.632141 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:TPU:1, TPU, 17179869184, 3647772474496170690)
I0515 23:50:44.632189 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:TPU:2, TPU, 17179869184, 13657477031661354568)
I0515 23:50:44.632236 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:TPU:3, TPU, 17179869184, 10273433667718972852)
I0515 23:50:44.632284 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:TPU:4, TPU, 17179869184, 12699679145622778621)
I0515 23:50:44.632330 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:TPU:5, TPU, 17179869184, 6649948106656892111)
I0515 23:50:44.632383 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:TPU:6, TPU, 17179869184, 1375185567063983108)
I0515 23:50:44.632431 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:TPU:7, TPU, 17179869184, 3451922344195583201)
I0515 23:50:44.632478 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:2/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 6409340960030849104)
I0515 23:50:44.632525 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:CPU:0, CPU, -1, 3269934438266134822)
I0515 23:50:44.632572 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:XLA_CPU:0, XLA_CPU, 17179869184, 16670124127912007275)
I0515 23:50:44.632619 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:TPU:0, TPU, 17179869184, 18274985617409654097)
I0515 23:50:44.632667 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:TPU:1, TPU, 17179869184, 3369307947303208944)
I0515 23:50:44.632713 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:TPU:2, TPU, 17179869184, 10602182275587413095)
I0515 23:50:44.632761 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:TPU:3, TPU, 17179869184, 11026399508796094888)
I0515 23:50:44.632818 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:TPU:4, TPU, 17179869184, 18201613861634062286)
I0515 23:50:44.632869 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:TPU:5, TPU, 17179869184, 975886697494237590)
I0515 23:50:44.632917 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:TPU:6, TPU, 17179869184, 6502230794022987185)
I0515 23:50:44.633026 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:TPU:7, TPU, 17179869184, 3624978036813481991)
I0515 23:50:44.633121 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:4/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 5646002544012212722)
I0515 23:50:44.633172 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:CPU:0, CPU, -1, 3334670248315637436)
I0515 23:50:44.633228 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:XLA_CPU:0, XLA_CPU, 17179869184, 5487407215926259564)
I0515 23:50:44.633279 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:TPU:0, TPU, 17179869184, 12776048597676943607)
I0515 23:50:44.633327 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:TPU:1, TPU, 17179869184, 3619280317034718645)
I0515 23:50:44.633382 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:TPU:2, TPU, 17179869184, 17930883732662025872)
I0515 23:50:44.633431 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:TPU:3, TPU, 17179869184, 9954883880359208926)
I0515 23:50:44.633478 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:TPU:4, TPU, 17179869184, 11740852691653466020)
I0515 23:50:44.633525 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:TPU:5, TPU, 17179869184, 14222181352287856990)
I0515 23:50:44.633572 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:TPU:6, TPU, 17179869184, 3201925422847433297)
I0515 23:50:44.633619 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:TPU:7, TPU, 17179869184, 6031994406375302804)
I0515 23:50:44.633673 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:5/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 12420998757014766605)
I0515 23:50:44.633722 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:CPU:0, CPU, -1, 10695344463261928307)
I0515 23:50:44.633775 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:XLA_CPU:0, XLA_CPU, 17179869184, 1605797391249364609)
I0515 23:50:44.633835 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:TPU:0, TPU, 17179869184, 4732342066183537167)
I0515 23:50:44.633886 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:TPU:1, TPU, 17179869184, 5650084867836613654)
I0515 23:50:44.633934 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:TPU:2, TPU, 17179869184, 5537626112561972712)
I0515 23:50:44.633984 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:TPU:3, TPU, 17179869184, 4358322155463677100)
I0515 23:50:44.634031 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:TPU:4, TPU, 17179869184, 10218287828731457209)
I0515 23:50:44.634078 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:TPU:5, TPU, 17179869184, 8596997315867636870)
I0515 23:50:44.634126 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:TPU:6, TPU, 17179869184, 11491195210514624470)
I0515 23:50:44.634175 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:TPU:7, TPU, 17179869184, 10346904376233237680)
I0515 23:50:44.634221 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:6/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 6718389490836589099)
I0515 23:50:44.634269 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:CPU:0, CPU, -1, 3848477348454434572)
I0515 23:50:44.634322 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:XLA_CPU:0, XLA_CPU, 17179869184, 14811366519076250353)
I0515 23:50:44.634377 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:TPU:0, TPU, 17179869184, 13958887647378951980)
I0515 23:50:44.634434 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:TPU:1, TPU, 17179869184, 18097771572312879880)
I0515 23:50:44.634500 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:TPU:2, TPU, 17179869184, 3983848003291086268)
I0515 23:50:44.634550 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:TPU:3, TPU, 17179869184, 7638836775938027298)
I0515 23:50:44.634597 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:TPU:4, TPU, 17179869184, 18239388122836864352)
I0515 23:50:44.634644 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:TPU:5, TPU, 17179869184, 3564497537452367522)
I0515 23:50:44.634698 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:TPU:6, TPU, 17179869184, 3546215355056542460)
I0515 23:50:44.634748 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:TPU:7, TPU, 17179869184, 8972579395659073818)
I0515 23:50:44.634796 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:3/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 5603140547989527936)
I0515 23:50:44.634864 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:CPU:0, CPU, -1, 17073729294351776647)
I0515 23:50:44.634924 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:XLA_CPU:0, XLA_CPU, 17179869184, 8864116385458341100)
I0515 23:50:44.634982 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:TPU:0, TPU, 17179869184, 8842732699064834571)
I0515 23:50:44.635036 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:TPU:1, TPU, 17179869184, 16596218965455720288)
I0515 23:50:44.635083 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:TPU:2, TPU, 17179869184, 6207231918796889208)
I0515 23:50:44.635130 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:TPU:3, TPU, 17179869184, 31079948229728117)
I0515 23:50:44.635179 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:TPU:4, TPU, 17179869184, 1618133782839928629)
I0515 23:50:44.635227 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:TPU:5, TPU, 17179869184, 12712811515482414011)
I0515 23:50:44.635274 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:TPU:6, TPU, 17179869184, 12282903537318239953)
I0515 23:50:44.635321 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:TPU:7, TPU, 17179869184, 7648446562677485660)
I0515 23:50:44.635373 139657779209984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:7/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 4212793266727527411)
W0515 23:50:44.640649 139657779209984 deprecation.py:323] From /usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
I0515 23:50:44.653989 139657779209984 estimator.py:1111] Calling model_fn.
W0515 23:50:44.667749 139657779209984 deprecation.py:323] From /home/yangyouucb/tpu-1/models/official/resnet/imagenet_input.py:294: DatasetV1.shard (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `dataset.apply(tf.data.experimental.filter_for_shard(...))`.
W0515 23:50:44.691020 139657779209984 deprecation.py:323] From /home/yangyouucb/tpu-1/models/official/resnet/imagenet_input.py:307: parallel_interleave (from tensorflow.contrib.data.python.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.experimental.parallel_interleave(...)`.
W0515 23:50:44.705770 139657779209984 deprecation.py:323] From /home/yangyouucb/tpu-1/models/official/resnet/imagenet_input.py:311: shuffle_and_repeat (from tensorflow.contrib.data.python.ops.shuffle_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.experimental.shuffle_and_repeat(...)`.
W0515 23:50:44.708472 139657779209984 deprecation.py:323] From /home/yangyouucb/tpu-1/models/official/resnet/imagenet_input.py:177: map_and_batch (from tensorflow.contrib.data.python.ops.batching) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.experimental.map_and_batch(...)`.
W0515 23:50:44.718845 139657779209984 deprecation.py:323] From /home/yangyouucb/tpu-1/models/official/resnet/resnet_preprocessing.py:66: sample_distorted_bounding_box (from tensorflow.python.ops.image_ops_impl) is deprecated and will be removed in a future version.
Instructions for updating:
`seed2` arg is deprecated.Use sample_distorted_bounding_box_v2 instead.
W0515 23:50:46.291180 139657779209984 deprecation.py:323] From /home/yangyouucb/tpu-1/models/official/resnet/resnet_model.py:208: conv2d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.conv2d instead.
W0515 23:50:46.307789 139657779209984 deprecation.py:323] From /home/yangyouucb/tpu-1/models/official/resnet/resnet_model.py:67: batch_normalization (from tensorflow.python.layers.normalization) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.batch_normalization instead.
W0515 23:50:46.353232 139657779209984 deprecation.py:323] From /home/yangyouucb/tpu-1/models/official/resnet/resnet_model.py:410: max_pooling2d (from tensorflow.python.layers.pooling) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.max_pooling2d instead.
W0515 23:50:49.920295 139657779209984 deprecation.py:323] From /home/yangyouucb/tpu-1/models/official/resnet/resnet_model.py:439: average_pooling2d (from tensorflow.python.layers.pooling) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.average_pooling2d instead.
W0515 23:50:49.925091 139657779209984 deprecation.py:323] From /home/yangyouucb/tpu-1/models/official/resnet/resnet_model.py:446: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
W0515 23:50:49.987085 139657779209984 deprecation.py:323] From /usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0515 23:50:50.267917 139657779209984 deprecation.py:323] From /usr/local/lib/python3.5/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
I0515 23:50:50.275514 139657779209984 lars_util.py:94] ***************** I am using LARS optimizer *****************
I0515 23:50:57.895240 139657779209984 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
I0515 23:50:58.178487 139657779209984 estimator.py:1113] Done calling model_fn.
I0515 23:51:01.202890 139657779209984 tpu_estimator.py:447] TPU job name worker
I0515 23:51:02.480449 139657779209984 monitored_session.py:222] Graph was finalized.
I0515 23:51:07.579395 139657779209984 session_manager.py:491] Running local_init_op.
I0515 23:51:07.773610 139657779209984 session_manager.py:493] Done running local_init_op.
I0515 23:51:16.801303 139657779209984 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/imagenet/infer/model.ckpt.
I0515 23:51:24.456513 139657779209984 util.py:51] Initialized dataset iterators in 0 seconds
I0515 23:51:24.457397 139657779209984 session_support.py:345] Installing graceful shutdown hook.
2019-05-15 23:51:24.457792: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
I0515 23:51:24.468927 139657779209984 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0', '/job:worker/replica:0/task:1/device:CPU:0', '/job:worker/replica:0/task:2/device:CPU:0', '/job:worker/replica:0/task:3/device:CPU:0', '/job:worker/replica:0/task:5/device:CPU:0', '/job:worker/replica:0/task:4/device:CPU:0', '/job:worker/replica:0/task:6/device:CPU:0', '/job:worker/replica:0/task:7/device:CPU:0']
I0515 23:51:24.655305 139657779209984 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0515 23:51:24.664009 139657779209984 tpu_estimator.py:504] Init TPU system
I0515 23:51:36.158985 139657779209984 tpu_estimator.py:510] Initialized TPU in 11 seconds
I0515 23:51:36.590232 139656417933056 tpu_estimator.py:463] Starting infeed thread controller.
I0515 23:51:36.590905 139656409540352 tpu_estimator.py:482] Starting outfeed thread controller.
I0515 23:51:36.801790 139657779209984 tpu_estimator.py:536] Enqueue next (1251) batch(es) of data to infeed.
I0515 23:51:36.802554 139657779209984 tpu_estimator.py:540] Dequeue next (1251) batch(es) of data from outfeed.
I0515 23:55:36.997701 139657779209984 basic_session_run_hooks.py:249] loss = 4.083763, step = 1251
I0515 23:55:37.000545 139657779209984 tpu_estimator.py:536] Enqueue next (1251) batch(es) of data to infeed.
I0515 23:55:37.001576 139657779209984 tpu_estimator.py:540] Dequeue next (1251) batch(es) of data from outfeed.
I0515 23:58:42.976458 139657779209984 basic_session_run_hooks.py:247] loss = 3.9624326, step = 2502 (185.979 sec)
I0515 23:58:42.978703 139657779209984 tpu_estimator.py:1858] global_step/sec: 6.72656
I0515 23:58:42.979432 139657779209984 tpu_estimator.py:1859] examples/sec: 55104
I0515 23:58:43.740822 139657779209984 tpu_estimator.py:536] Enqueue next (1251) batch(es) of data to infeed.
I0515 23:58:43.742112 139657779209984 tpu_estimator.py:540] Dequeue next (1251) batch(es) of data from outfeed.
I0516 00:01:51.112827 139657779209984 basic_session_run_hooks.py:247] loss = 3.457911, step = 3753 (188.136 sec)
I0516 00:01:51.114707 139657779209984 tpu_estimator.py:1858] global_step/sec: 6.64945
I0516 00:01:51.114936 139657779209984 tpu_estimator.py:1859] examples/sec: 54472.3
I0516 00:01:51.822400 139657779209984 tpu_estimator.py:536] Enqueue next (1251) batch(es) of data to infeed.
I0516 00:01:51.822781 139657779209984 tpu_estimator.py:540] Dequeue next (1251) batch(es) of data from outfeed.
I0516 00:04:55.721128 139657779209984 basic_session_run_hooks.py:594] Saving checkpoints for 5004 into gs://bert-pretrain-data/imagenet/infer/model.ckpt.
I0516 00:05:02.878415 139657779209984 basic_session_run_hooks.py:247] loss = 3.008086, step = 5004 (191.766 sec)
I0516 00:05:02.880138 139657779209984 tpu_estimator.py:1858] global_step/sec: 6.5236
I0516 00:05:02.880391 139657779209984 tpu_estimator.py:1859] examples/sec: 53441.3
I0516 00:05:02.881600 139657779209984 tpu_estimator.py:536] Enqueue next (1251) batch(es) of data to infeed.
I0516 00:05:02.881836 139657779209984 tpu_estimator.py:540] Dequeue next (1251) batch(es) of data from outfeed.
